# DjangoLearning
***
## previous work

* check django version
    ```python
    python -m django --version
    ```
* create a project
    ```python
    django-admin startproject mysite
    ```
    Do this step will create a directory named mysite with some files inside it.
    The 'mysite' can be changed by any name you want.
* runserver
    ```python
    python manage.py runserver
    ```
* check your broswer
    ```python
    http://127.0.0.1:8000/
    ```
* create an app
    ```python
    python manage.py startapp polls
    ```
    Do this step will create a directory named polls with some files inside it.
    The 'polls' can be changed by any name you want.
* create the first view
    ```python
    # polls/views.py
    from django.http import HttpResponse


    def index(request):
        return HttpResponse("Hello, world. You're at the polls index.")
    ```
* create a URLconf for polls app
    create a file named urls.py in dictionary polls
* set url mapping
    * in project mysite
        ```python
        from django.contrib import admin
        from django.urls import include, path

        urlpatterns = [
            path('polls/', include('polls.urls')),
            path('admin/', admin.site.urls),
        ]
        ```
    * in app polls
        ```python
        from django.urls import path

        from . import views

        urlpatterns = [
            path('', views.index, name='index'),
        ]    
        ```
* check your broswer
    ```python
    http://127.0.0.1:8000/polls
    ```
## database and model

* database setup
    In official documentation, SQLite is used as database.
    I will use MySQL as the database of the project.
    I need three steps to connect Django with MySQL.
    * change the setting file
        ```python
        DATABASES = {
            'default': {
                'ENGINE': 'django.db.backends.mysql',
                'NAME': 'mysite',
                'USER': 'root',
                'PASSWORD': '123456',
                'HOST': '127.0.0.1',
                'PORT': '3306',
            }
        }  
        ```
    * install pymysql
    in terminal
    ```python
    pip install pymysql
    ```
    * modify the __init__.py file in project
* create tables in database
    * why create tables
        Django integrated 6 app helps us developing conveniencly.
        However, some of these applications make use of at least one database table, though, so we need to create the tables in the database before we can use them. 
    * step one
        ```python
        python manage.py migrate
        ```
        Doing this, several tables will be created in our database by django.
* create models
    * why create models
        A model in django maps a table in database.
        Our data need to be stored in database by model.
    * modify polls/models.py
        ```python
        from django.db import models


        class Question(models.Model):
            question_text = models.CharField(max_length=200)
            pub_date = models.DateTimeField('date published')


        class Choice(models.Model):
            question = models.ForeignKey(Question, on_delete=models.CASCADE)
            choice_text = models.CharField(max_length=200)
            votes = models.IntegerField(default=0)
        ```
* activationg models
    * First we need to tell our project that the polls app is installed.
       We need to modify the project settings.py.
       ```python
        INSTALLED_APPS = [
            'polls.apps.PollsConfig',
            'django.contrib.admin',
            'django.contrib.auth',
            'django.contrib.contenttypes',
            'django.contrib.sessions',
            'django.contrib.messages',
            'django.contrib.staticfiles',
        ]
       ``` 
    * then run another command
        ```python
        python manage.py makemigrations polls
        ```
        By running makemigrations, you’re telling Django that you’ve made some changes to your models (in this case, you’ve made new ones) and that you’d like the changes to be stored as a migration.
        We can find that
        ```python
        Migrations for 'polls':
        polls\migrations\0001_initial.py
            - Create model Question       
            - Create model Choice          
        ```
        in terminal
        Besides, 0001_initial.py file was created by django, which content is that:
        ```python
        # Generated by Django 3.2.10 on 2022-03-16 08:53

        from django.db import migrations, models
        import django.db.models.deletion


        class Migration(migrations.Migration):

            initial = True

            dependencies = [
            ]

            operations = [
                migrations.CreateModel(
                    name='Question',
                    fields=[
                        ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                        ('question_text', models.CharField(max_length=200)),
                        ('pub_date', models.DateTimeField(verbose_name='date published')),
                    ],
                ),
                migrations.CreateModel(
                    name='Choice',
                    fields=[
                        ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                        ('choice_text', models.CharField(max_length=200)),
                        ('votes', models.IntegerField(default=0)),
                        ('question', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='polls.question')),
                    ],
                ),
            ]
                
        ```
    * then run this command to see what SQL that migration would run
        ```python
            python manage.py sqlmigrate polls 0001
        ```
        we can see SQL in terminal
        ```sql
        --                      
        -- Create model Question
        --                      
        CREATE TABLE `polls_question` (`id` bigint AUTO_INCREMENT NOT NULL PRIMARY KEY, `question_text` varchar(200) NOT
        NULL, `pub_date` datetime(6) NOT NULL);
        --
        -- Create model Choice
        --
        CREATE TABLE `polls_choice` (`id` bigint AUTO_INCREMENT NOT NULL PRIMARY KEY, `choice_text` varchar(200) NOT NUL
        L, `votes` integer NOT NULL, `question_id` bigint NOT NULL);
        ALTER TABLE `polls_choice` ADD CONSTRAINT `polls_choice_question_id_c5b4b260_fk_polls_question_id` FOREIGN KEY (
        `question_id`) REFERENCES `polls_question` (`id`);

        ```
        Note that :The sqlmigrate command doesn’t actually run the migration on your database - instead, it prints it to the screen so that you can see what SQL Django thinks is required. 
    * run migrate again to create those model tables in your database
        ```python
        python manage.py migrate
        ```
        Now two new tables polls_choice and polls_question have been created in database by django.
* use API
    